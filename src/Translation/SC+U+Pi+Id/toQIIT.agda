open import Prelude

module Translation.SC+U+Pi+Id.toQIIT where

open import Theory.SC+U+Pi+Id.QIIT.Syntax     as QIIT
open import Theory.SC+U+Pi+Id.QIIT.Properties as QIIT

import Theory.SC+U+Pi+Id.QIIRT.Syntax as R
  hiding (i)

open import Theory.SC+U+Pi+Id.QIIRT.Elimination

open Eliminator

open â‰¡-Reasoning
toQIIT : Eliminator 
toQIIT .mot = record
  { Ctxá´¹ = Î» Î“ â†’ Ctx
  ; Tyá´¹  = Î» Î“ i A â†’ Ty Î“ i
  ; Subá´¹ = Î» Î“ Î” Ïƒ â†’ Sub Î“ Î”
  ; Tmá´¹  = Î» Î“ A t â†’ Tm Î“ A
  }
toQIIT .met = record
  { ğ’    = record
    { [_]á´¹_       = [_]_
    ; âˆ…á¶œá´¹         = âˆ…
    ; _,á¶œá´¹_       = _,_
    ; âˆ…Ë¢á´¹         = âˆ…
    ; _,Ë¢á´¹_       = Î» Ïƒ t â†’ Ïƒ , t
    ; idSá´¹        = idS
    ; _â¨Ÿá´¹_        = _â¨Ÿ_
    ; Ï€â‚á´¹         = Ï€â‚
    ; [idSá´¹]      = [idS]
    ; [â¨Ÿá´¹]á´¹       = [â¨Ÿ]
    ; [Ï€â‚á´¹,Ë¢á´¹]á´¹   = Î» {Aá´¹ = Aá´¹} â†’ cong ([_] Aá´¹) Ï€â‚,
    ; [Ï€â‚á´¹â¨Ÿá´¹]á´¹    = Î» {Aá´¹ = Aá´¹} â†’ cong ([_] Aá´¹) (Ï€â‚â¨Ÿ _ _) âˆ™ [â¨Ÿ]
    ; Ï€â‚‚á´¹         = Ï€â‚‚
    ; [_]tmá´¹_     = [_]tm_
    ; _â†‘á´¹_        = Î» Ïƒ A â†’ Ïƒ â†‘ A
    ; idSá´¹â†‘á´¹      = idâº _ _
    ; â¨Ÿá´¹â†‘á´¹        = Î» {Î“} {Î“á´¹} {Î”} {Î”á´¹} {Ïƒ} {Ïƒá´¹} {Î˜} {Î˜á´¹} {Ï„} {Ï„á´¹} {_} {A} {Aá´¹} â†’ â¨Ÿâº Ïƒá´¹ Ï„á´¹ Aá´¹
    ; Ï€â‚á´¹,Ë¢á´¹â†‘á´¹    = Ï€â‚,âº
    ; Ï€â‚á´¹â¨Ÿá´¹â†‘á´¹     = Ï€â‚â¨Ÿâº
    ; âˆ…Ë¢á´¹â†‘á´¹       = refl
    ; ,Ë¢á´¹â†‘á´¹       = refl
    ; Ï€â‚á´¹idSá´¹â†‘á´¹   = refl
    ; Ï€â‚á´¹Ï€â‚á´¹â†‘á´¹    = refl
    ; [_]tá´¹_      = Î» Ïƒ t â†’ [ Ïƒ ]tm t
    ; [idSá´¹]tá´¹    = [idS]tm
    ; [â¨Ÿá´¹]tá´¹      = [â¨Ÿ]tm
    ; [Ï€â‚á´¹,Ë¢á´¹]tá´¹  = (sym $ tr-cong Ï€â‚,) âˆ™ apd ([_]tm _) Ï€â‚,
    ; [Ï€â‚á´¹â¨Ÿá´¹]tá´¹   = Î» {Î“} {Î“á´¹} {Î”} {Î”á´¹} {Ïƒ} {Ïƒá´¹} {Î˜} {i} {A} {Ï„} {Î˜á´¹} {Aá´¹} {Ï„á´¹} {j} {B} {Bá´¹} {t} {tá´¹}
      â†’ begin -- L-T (11-01-2025: All about transports ...)
        tr (Tm Î“á´¹) (trans (cong ([_] Bá´¹) (Ï€â‚â¨Ÿ Ïƒá´¹ Ï„á´¹)) [â¨Ÿ]) ([ Ï€â‚ (Ïƒá´¹ â¨Ÿ Ï„á´¹) ]tm tá´¹)
          â‰¡âŸ¨ trÂ² (cong ([_] Bá´¹) (Ï€â‚â¨Ÿ Ïƒá´¹ Ï„á´¹)) âŸ¨
        tr (Tm Î“á´¹) [â¨Ÿ] (tr (Tm Î“á´¹) (cong ([_] Bá´¹) (Ï€â‚â¨Ÿ Ïƒá´¹ Ï„á´¹)) ([ Ï€â‚ (Ïƒá´¹ â¨Ÿ Ï„á´¹) ]tm tá´¹))
          â‰¡âŸ¨ cong (tr (Tm Î“á´¹) [â¨Ÿ]) (tr-cong (Ï€â‚â¨Ÿ Ïƒá´¹ Ï„á´¹)) âŸ¨
        tr (Tm Î“á´¹) [â¨Ÿ] (tr (Î» Ïƒ â†’ Tm Î“á´¹ ([ Ïƒ ] Bá´¹)) (Ï€â‚â¨Ÿ Ïƒá´¹ Ï„á´¹) ([ Ï€â‚ (Ïƒá´¹ â¨Ÿ Ï„á´¹) ]tm tá´¹))
          â‰¡âŸ¨ cong (tr (Tm Î“á´¹) [â¨Ÿ]) (apd ([_]tm tá´¹) (Ï€â‚â¨Ÿ Ïƒá´¹ Ï„á´¹)) âŸ©
        tr (Tm Î“á´¹) [â¨Ÿ] ([ Ïƒá´¹ â¨Ÿ Ï€â‚ Ï„á´¹ ]tm tá´¹)
          â‰¡âŸ¨ [â¨Ÿ]tm âŸ©
        [ Ïƒá´¹ ]tm [ Ï€â‚ Ï„á´¹ ]tm tá´¹
          âˆ
    ; [âˆ…Ë¢á´¹]tá´¹     = refl
    ; [,Ë¢á´¹]tá´¹     = refl
    ; [Ï€â‚á´¹idSá´¹]tá´¹ = refl
    ; [Ï€â‚á´¹Ï€â‚á´¹]tá´¹  = refl
    ; _â¨Ÿá´¹idSá´¹     = Î» _
      â†’ (tr-const (_ R.â¨ŸidS)) âˆ™ (_ â¨ŸidS)
    ; idSá´¹â¨Ÿá´¹_     = Î» Ïƒá´¹
      â†’ (tr-const (R.idSâ¨Ÿ _)) âˆ™ (idSâ¨Ÿ _)
    ; â¨Ÿá´¹-assoc    = tr-const R.â¨Ÿ-assoc âˆ™ â¨Ÿ-assoc
    ; Ï€â‚á´¹,Ë¢á´¹      = tr-const R.Ï€â‚, âˆ™ Ï€â‚,
    ; â¨Ÿá´¹,Ë¢á´¹       = tr-const R.â¨Ÿ, âˆ™ â¨Ÿ,
    ; Î·âˆ…Ë¢á´¹        = tr-const R.Î·âˆ… âˆ™ Î·âˆ…
    ; Î·,Ë¢á´¹        = tr-const R.Î·, âˆ™ Î·,
    ; [idSá´¹]tmá´¹   = cong (tr (Tm _) [idS]) (tr-const R.[idS]tm) âˆ™ [idS]tm
    ; [â¨Ÿá´¹]tmá´¹     = cong (tr (Tm _) [â¨Ÿ]) (tr-const R.[â¨Ÿ]tm) âˆ™ [â¨Ÿ]tm
    ; Ï€â‚‚á´¹,Ë¢á´¹      = Î» {Î“} {Î“á´¹} {Î”} {Î”á´¹} {Ïƒ} {Ïƒá´¹} {i} {A} {t} {Aá´¹} {tá´¹}
      â†’ begin
        tr (Tm Î“á´¹) (cong ([_] Aá´¹) Ï€â‚,) (tr (Î» _ â†’ Tm Î“á´¹ ([ Ï€â‚ (Ïƒá´¹ , tá´¹) ] Aá´¹)) R.Ï€â‚‚, (Ï€â‚‚ (Ïƒá´¹ , tá´¹)))
          â‰¡âŸ¨ tr-cong Ï€â‚, âŸ¨
        tr (Î» Ïƒ â†’ Tm Î“á´¹ ([ Ïƒ ] Aá´¹)) Ï€â‚, (tr (Î» _ â†’ Tm Î“á´¹ ([ Ï€â‚ (Ïƒá´¹ , tá´¹) ] Aá´¹)) R.Ï€â‚‚, (Ï€â‚‚ (Ïƒá´¹ , tá´¹)))
          â‰¡âŸ¨ cong (tr (Î» Ïƒ â†’ Tm Î“á´¹ ([ Ïƒ ] Aá´¹)) Ï€â‚,) (tr-const R.Ï€â‚‚,) âŸ©
        tr (Î» Ïƒ â†’ Tm Î“á´¹ ([ Ïƒ ] Aá´¹)) Ï€â‚, (Ï€â‚‚ (Ïƒá´¹ , tá´¹))
          â‰¡âŸ¨ Ï€â‚‚, âŸ©
        tá´¹
          âˆ
    }
  ; univ = record
    { Uá´¹       = U
    ; Elá´¹      = El
    ; Liftá´¹    = Lift
    ; cá´¹       = c
    ; mká´¹      = mk
    ; uná´¹      = un
    ; []á´¹Uá´¹    = []U
    ; []á´¹Elá´¹   = []El
    ; []á´¹Liftá´¹ = []Lift
    ; []tá´¹cá´¹   = Î» Ïƒá´¹ Aá´¹ â†’
      cong (tr (Tm _) []U) (tr-const (R.[]tc _ _)) âˆ™ ([]tc Ïƒá´¹ Aá´¹)
    ; []mká´¹    = Î» Ïƒ  Ïƒá´¹ â†’
      cong (tr (Tm _) []Lift) (tr-const (R.[]mk Ïƒ _)) âˆ™ []mk Ïƒá´¹ _
    ; []uná´¹    = Î» Ïƒ Ïƒá´¹ â†’
      tr-const (R.[]un Ïƒ _ _) âˆ™  []un Ïƒá´¹ _ _
    ; Uá´¹Î²      = tr-const R.UÎ² âˆ™ UÎ²
    ; Uá´¹Î·      = tr-const R.UÎ· âˆ™ UÎ·
    ; Liftá´¹Î²   = tr-const R.LiftÎ² âˆ™ LiftÎ²
    ; Liftá´¹Î·   = tr-const R.LiftÎ· âˆ™ LiftÎ·
    }
  ; piTy = record
    { Î á´¹    = Î 
    ; Æ›á´¹_   = Æ›_
    ; appá´¹  = app
    ; []á´¹Î á´¹ = []Î 
    ; []Æ›á´¹  = Î» {Î“} {Î”} {Î“á´¹} {Î”á´¹} {i} {A} {B} {Aá´¹} {Bá´¹} {t} {tá´¹} Ïƒ Ïƒá´¹
      â†’ cong (tr (Tm Î“á´¹) []Î ) (tr-const (R.[]Æ› Ïƒ t)) âˆ™ []Æ› Ïƒá´¹ tá´¹ }
  ; idTy = record
    { Idá´¹      = Id
    ; []á´¹Idá´¹   = []Id
    ; reflectá´¹ = Î» where
      {p = p} pá´¹ â†’ tr-const (R.reflect p) âˆ™ reflect pá´¹
    }
  }
