module Theory.SC+El+Pi+B.QIIRT-tyOf.Rec where

open import Prelude

open import Theory.SC+El+Pi+B.QIIRT-tyOf.Syntax

record Motive (РёЊРѓЂ РёЊРѓѓ РёЊРѓЃ РёЊРѓё : Level) : Set (РёЊ-suc (РёЊРѓЂ Ріћ РёЊРѓѓ Ріћ РёЊРѓЃ Ріћ РёЊРѓё)) where
  field
    Ctxр┤г : Set РёЊРѓЂ
    Tyр┤г : Ctxр┤г Рєњ Set РёЊРѓѓ
    Subр┤г : Ctxр┤г Рєњ Ctxр┤г Рєњ Set РёЊРѓЃ
    Tmр┤г : Ctxр┤г Рєњ Set РёЊРѓё
    tyOfр┤г : {╬Њр┤╣ : Ctxр┤г} Рєњ Tmр┤г ╬Њр┤╣ Рєњ Tyр┤г ╬Њр┤╣

  variable
    ╬Њр┤╣ ╬ћр┤╣ ╬ўр┤╣ ╬ър┤╣ : Ctxр┤г
    Aр┤╣ Bр┤╣ Cр┤╣ Dр┤╣ : Tyр┤г ╬Њр┤╣
    ¤Ѓр┤╣ ¤ёр┤╣ ╬│р┤╣    : Subр┤г ╬Њр┤╣ ╬ћр┤╣
    tр┤╣ uр┤╣ vр┤╣    : Tmр┤г ╬Њр┤╣

-- Recursor

module _ (mot : Motive РёЊРѓЂ РёЊРѓѓ РёЊРѓЃ РёЊРѓё) where
  open Motive mot

  record SCр┤╣ : Set (РёЊРѓЂ Ріћ РёЊРѓѓ Ріћ РёЊРѓЃ Ріћ РёЊРѓё) where
    field
      РѕЁр┤╣
        : Ctxр┤г
      _,р┤╣_
        : (╬Њр┤╣ : Ctxр┤г)(Aр┤╣ : Tyр┤г ╬Њр┤╣)
        Рєњ Ctxр┤г
      _[_]Tр┤╣
        : (Aр┤╣ : Tyр┤г ╬ћр┤╣)(¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣)
        Рєњ Tyр┤г ╬Њр┤╣
      _[_]tр┤╣
        : (tр┤╣ : Tmр┤г ╬ћр┤╣)(¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣)
        Рєњ Tmр┤г ╬Њр┤╣
      tyOf[]р┤╣
        : tyOfр┤г (tр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) РЅА (tyOfр┤г tр┤╣) [ ¤Ѓр┤╣ ]Tр┤╣
      РѕЁSр┤╣
        : Subр┤г ╬Њр┤╣ РѕЁр┤╣
      _,р┤╣_РѕХ[_]
        : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (tр┤╣ : Tmр┤г ╬Њр┤╣) Рєњ tyOfр┤г tр┤╣ РЅА Aр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣
        Рєњ Subр┤г ╬Њр┤╣ (╬ћр┤╣ ,р┤╣ Aр┤╣)
      idSр┤╣
        : Subр┤г ╬Њр┤╣ ╬Њр┤╣
      _Рѕўр┤╣_
        : Subр┤г ╬ћр┤╣ ╬ўр┤╣ Рєњ Subр┤г ╬Њр┤╣ ╬ћр┤╣
        Рєњ Subр┤г ╬Њр┤╣ ╬ўр┤╣
      ¤ђРѓЂр┤╣
        : Subр┤г ╬Њр┤╣ (╬ћр┤╣ ,р┤╣ Aр┤╣)
        Рєњ Subр┤г ╬Њр┤╣ ╬ћр┤╣
      ¤ђРѓѓр┤╣
        : Subр┤г ╬Њр┤╣ (╬ћр┤╣ ,р┤╣ Aр┤╣)
        Рєњ Tmр┤г ╬Њр┤╣
      tyOf¤ђРѓѓр┤╣
        : tyOfр┤г (¤ђРѓѓр┤╣ ¤Ѓр┤╣) РЅА Aр┤╣ [ ¤ђРѓЂр┤╣ ¤Ѓр┤╣ ]Tр┤╣
      idSРѕўр┤╣_
        : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣)
        Рєњ idSр┤╣ Рѕўр┤╣ ¤Ѓр┤╣ РЅА ¤Ѓр┤╣
      _РѕўidSр┤╣
        : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣)
        Рєњ ¤Ѓр┤╣ Рѕўр┤╣ idSр┤╣ РЅА ¤Ѓр┤╣
      assocSр┤╣
        : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (¤ёр┤╣ : Subр┤г ╬ћр┤╣ ╬ўр┤╣) (╬│р┤╣ : Subр┤г ╬ўр┤╣ ╬ър┤╣)
        Рєњ (╬│р┤╣ Рѕўр┤╣ ¤ёр┤╣) Рѕўр┤╣ ¤Ѓр┤╣ РЅА ╬│р┤╣ Рѕўр┤╣ (¤ёр┤╣ Рѕўр┤╣ ¤Ѓр┤╣)
      ,Рѕўр┤╣
        : (¤Ѓр┤╣ : Subр┤г ╬ћр┤╣ ╬ўр┤╣) (tр┤╣ : Tmр┤г ╬ћр┤╣) (¤ёр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (p : tyOfр┤г tр┤╣ РЅА Aр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣)
          (q : tyOfр┤г (tр┤╣ [ ¤ёр┤╣ ]tр┤╣) РЅА Aр┤╣ [ ¤Ѓр┤╣ Рѕўр┤╣ ¤ёр┤╣ ]Tр┤╣)
        Рєњ (¤Ѓр┤╣ ,р┤╣ tр┤╣ РѕХ[ p ]) Рѕўр┤╣ ¤ёр┤╣ РЅА ((¤Ѓр┤╣ Рѕўр┤╣ ¤ёр┤╣) ,р┤╣ tр┤╣ [ ¤ёр┤╣ ]tр┤╣ РѕХ[ q ])
      ╬и¤ђр┤╣
        : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ (╬ћр┤╣ ,р┤╣ Aр┤╣))
        Рєњ ¤Ѓр┤╣ РЅА (¤ђРѓЂр┤╣ ¤Ѓр┤╣ ,р┤╣ ¤ђРѓѓр┤╣ ¤Ѓр┤╣ РѕХ[ tyOf¤ђРѓѓр┤╣ ])
      ╬иРѕЁр┤╣
        : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ РѕЁр┤╣)
        Рєњ ¤Ѓр┤╣ РЅА РѕЁSр┤╣
      ╬▓¤ђРѓЂр┤╣
        : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (tр┤╣ : Tmр┤г ╬Њр┤╣) (p : tyOfр┤г tр┤╣ РЅА Aр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣)
        Рєњ ¤ђРѓЂр┤╣ (¤Ѓр┤╣ ,р┤╣ tр┤╣ РѕХ[ p ]) РЅА ¤Ѓр┤╣
      ╬▓¤ђРѓѓр┤╣
        : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (tр┤╣ : Tmр┤г ╬Њр┤╣) (p : tyOfр┤г tр┤╣ РЅА Aр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣)
        Рєњ (q : Aр┤╣ [ ¤ђРѓЂр┤╣ (¤Ѓр┤╣ ,р┤╣ tр┤╣ РѕХ[ p ]) ]Tр┤╣ РЅА  tyOfр┤г tр┤╣)
        Рєњ ¤ђРѓѓр┤╣ (¤Ѓр┤╣ ,р┤╣ tр┤╣ РѕХ[ p ]) РЅА tр┤╣
      [idS]Tр┤╣
        : Aр┤╣ РЅА Aр┤╣ [ idSр┤╣ ]Tр┤╣
      [Рѕў]Tр┤╣
        : (Aр┤╣ : Tyр┤г ╬ўр┤╣) (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (¤ёр┤╣ : Subр┤г ╬ћр┤╣ ╬ўр┤╣)
        Рєњ Aр┤╣ [ ¤ёр┤╣ ]Tр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣ РЅА Aр┤╣ [ ¤ёр┤╣ Рѕўр┤╣ ¤Ѓр┤╣ ]Tр┤╣
      [idS]tр┤╣
        : (tр┤╣ : Tmр┤г ╬Њр┤╣)
        Рєњ tр┤╣ РЅА tр┤╣ [ idSр┤╣ ]tр┤╣
      [Рѕў]tр┤╣
        : (tр┤╣ : Tmр┤г ╬ўр┤╣) (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (¤ёр┤╣ : Subр┤г ╬ћр┤╣ ╬ўр┤╣)
        Рєњ tр┤╣ [ ¤ёр┤╣ ]tр┤╣ [ ¤Ѓр┤╣ ]tр┤╣ РЅА tр┤╣ [ ¤ёр┤╣ Рѕўр┤╣ ¤Ѓр┤╣ ]tр┤╣
      Uр┤╣
        : Tyр┤г ╬Њр┤╣
      U[]р┤╣
        : Uр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣ РЅА Uр┤╣

    --  tyOf¤ђРѓѓidSр┤╣
    --    : tyOfр┤г (¤ђРѓѓр┤╣ {Aр┤╣ = Aр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣} idSр┤╣) РЅА Aр┤╣ [ ¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣ ]Tр┤╣
    -- [TODO] Do we need derived equations in recursor/eliminator?
    -- Derived equations are used to make the definition strictly positivie, not an issue for records.
    -- So, delete this for now to see if need it in an recorsor

    tyOf¤ђРѓѓidSр┤╣
      : tyOfр┤г (¤ђРѓѓр┤╣ idSр┤╣) РЅА Aр┤╣ [ ¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣ ]Tр┤╣
    tyOf¤ђРѓѓidSр┤╣ {Aр┤╣ = Aр┤╣} {¤Ѓр┤╣ = ¤Ѓр┤╣} = 
      tyOfр┤г (¤ђРѓѓр┤╣ idSр┤╣)
        РЅАРЪе tyOf¤ђРѓѓр┤╣ РЪЕ
      (Aр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣) [ ¤ђРѓЂр┤╣ idSр┤╣ ]Tр┤╣
        РЅАРЪе [Рѕў]Tр┤╣ _ _ _ РЪЕ
      Aр┤╣ [ ¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣ ]Tр┤╣
        Рѕј

    _РєЉр┤╣_
      : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (Aр┤╣ : Tyр┤г ╬ћр┤╣)
      Рєњ Subр┤г (╬Њр┤╣ ,р┤╣ (Aр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣)) (╬ћр┤╣ ,р┤╣ Aр┤╣)
    ¤Ѓр┤╣ РєЉр┤╣ Aр┤╣ = (¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣) ,р┤╣ ¤ђРѓѓр┤╣ idSр┤╣ РѕХ[ tyOf¤ђРѓѓidSр┤╣ ]

  record Univр┤╣ (C : SCр┤╣): Set (РёЊРѓЂ Ріћ РёЊРѓѓ Ріћ РёЊРѓЃ Ріћ РёЊРѓё) where
    open SCр┤╣ C

    tyOf[]РЅАUр┤╣
      : (p : tyOfр┤г uр┤╣ РЅА Uр┤╣)
      Рєњ tyOfр┤г (uр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) РЅА Uр┤╣
    tyOf[]РЅАUр┤╣ {¤Ѓр┤╣ = ¤Ѓр┤╣} p = tyOf[]р┤╣ РѕЎ cong (╬╗ A Рєњ A [ ¤Ѓр┤╣ ]Tр┤╣) p РѕЎ U[]р┤╣ {¤Ѓр┤╣ = ¤Ѓр┤╣}

    field
      Elр┤╣
        : (uр┤╣ : Tmр┤г ╬Њр┤╣) (p : tyOfр┤г uр┤╣ РЅА Uр┤╣)
        Рєњ Tyр┤г ╬Њр┤╣
      El[]р┤╣
        : (¤ёр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) (uр┤╣ : Tmр┤г ╬ћр┤╣) (p : tyOfр┤г uр┤╣ РЅА Uр┤╣)
        Рєњ (Elр┤╣ uр┤╣ p) [ ¤ёр┤╣ ]Tр┤╣ РЅА Elр┤╣ (uр┤╣ [ ¤ёр┤╣ ]tр┤╣) (tyOf[]РЅАUр┤╣ p)

  record Piр┤╣ (C : SCр┤╣): Set (РёЊРѓЂ Ріћ РёЊРѓѓ Ріћ РёЊРѓЃ Ріћ РёЊРѓё) where
    open SCр┤╣ C

    field
      ╬ар┤╣
        : (Aр┤╣ : Tyр┤г ╬Њр┤╣) (Bр┤╣ : Tyр┤г (╬Њр┤╣  ,р┤╣ Aр┤╣ ))
        Рєњ Tyр┤г ╬Њр┤╣
      appр┤╣
        : (tр┤╣ : Tmр┤г ╬Њр┤╣) Рєњ tyOfр┤г tр┤╣ РЅА ╬ар┤╣ Aр┤╣ Bр┤╣
        Рєњ Tmр┤г (╬Њр┤╣  ,р┤╣ Aр┤╣)
      tyOfappр┤╣
        : (p : _)
        Рєњ tyOfр┤г (appр┤╣ {Bр┤╣ = Bр┤╣} tр┤╣ p) РЅА Bр┤╣
      absр┤╣
        : (tр┤╣ : Tmр┤г (╬Њр┤╣  ,р┤╣ Aр┤╣ ))
        Рєњ Tmр┤г ╬Њр┤╣ 
      tyOfabsр┤╣
        : tyOfр┤г (absр┤╣ tр┤╣) РЅА ╬ар┤╣ Aр┤╣  (tyOfр┤г tр┤╣)
      ╬а[]р┤╣
        : (╬ар┤╣ Aр┤╣ Bр┤╣) [ ¤Ѓр┤╣ ]Tр┤╣ РЅА ╬ар┤╣ (Aр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣) (Bр┤╣ [ ¤Ѓр┤╣ РєЉр┤╣ Aр┤╣  ]Tр┤╣)
      abs[]р┤╣
        : (tр┤╣ : Tmр┤г (╬Њр┤╣  ,р┤╣ Aр┤╣))
        Рєњ absр┤╣ tр┤╣ [ ¤Ѓр┤╣ ]tр┤╣ РЅА absр┤╣ (tр┤╣ [ ¤Ѓр┤╣ РєЉр┤╣ Aр┤╣  ]tр┤╣)
      ╬а╬▓р┤╣
        : (tр┤╣ : Tmр┤г (╬Њр┤╣  ,р┤╣ Aр┤╣ )) 
        Рєњ appр┤╣ (absр┤╣ tр┤╣) tyOfabsр┤╣ РЅА tр┤╣
      ╬а╬ир┤╣
        : (tр┤╣ : Tmр┤г ╬Њр┤╣ ) (p : tyOfр┤г tр┤╣ РЅА ╬ар┤╣ Aр┤╣ Bр┤╣)
        Рєњ absр┤╣ (appр┤╣ tр┤╣ p) РЅА tр┤╣

  record Boolр┤╣ (C : SCр┤╣): Set (РёЊРѓЂ Ріћ РёЊРѓѓ Ріћ РёЊРѓЃ Ріћ РёЊРѓё) where
    open SCр┤╣ C

    field
      ­Юћ╣р┤╣
        : Tyр┤г ╬Њр┤╣
      ­Юћ╣[]р┤╣
        : ­Юћ╣р┤╣ [ ¤Ѓр┤╣ ]Tр┤╣ РЅА ­Юћ╣р┤╣
      ttр┤╣ ffр┤╣
        : Tmр┤г ╬Њр┤╣ 
      tyOfttр┤╣
        : tyOfр┤г {╬Њр┤╣} ttр┤╣ РЅА ­Юћ╣р┤╣ [ idSр┤╣ ]Tр┤╣
      tyOfffр┤╣
        : tyOfр┤г {╬Њр┤╣} ffр┤╣ РЅА ­Юћ╣р┤╣ [ idSр┤╣ ]Tр┤╣
      tt[]р┤╣
        : ttр┤╣ [ ¤Ѓр┤╣ ]tр┤╣  РЅА ttр┤╣ 
      ff[]р┤╣
        : ffр┤╣ [ ¤Ѓр┤╣ ]tр┤╣  РЅА ffр┤╣

    ­Юћ╣[]Рѓѓр┤╣
      : tyOfр┤г (¤ђРѓѓр┤╣ {╬Њр┤╣ ,р┤╣ ­Юћ╣р┤╣} idSр┤╣ ) РЅА ­Юћ╣р┤╣ [ ¤ёр┤╣ ]Tр┤╣
    ­Юћ╣[]Рѓѓр┤╣ {╬Њр┤╣ = ╬Њр┤╣} {¤ёр┤╣ = ¤ёр┤╣} =
      tyOfр┤г (¤ђРѓѓр┤╣ {╬Њр┤╣ ,р┤╣ ­Юћ╣р┤╣} idSр┤╣ )
        РЅАРЪе tyOf¤ђРѓѓр┤╣ РЪЕ
      ­Юћ╣р┤╣ [ ¤ђРѓЂр┤╣ idSр┤╣ ]Tр┤╣
        РЅАРЪе ­Юћ╣[]р┤╣ РЪЕ
      ­Юћ╣р┤╣
        РЅАРЪе sym ­Юћ╣[]р┤╣ РЪЕ
      ­Юћ╣р┤╣ [ ¤ёр┤╣ ]Tр┤╣
        Рѕј

    _РєЉ­Юћ╣р┤╣
      : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣)
      Рєњ Subр┤г (╬Њр┤╣ ,р┤╣ ­Юћ╣р┤╣) (╬ћр┤╣ ,р┤╣ ­Юћ╣р┤╣)
    ¤Ѓр┤╣ РєЉ­Юћ╣р┤╣ = (¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣) ,р┤╣ ¤ђРѓѓр┤╣ idSр┤╣ РѕХ[ ­Юћ╣[]Рѓѓр┤╣ {¤ёр┤╣ = ¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣} ]

    field
      elim­Юћ╣р┤╣
        : (P : Tyр┤г (╬Њр┤╣ ,р┤╣ ­Юћ╣р┤╣)) (tр┤╣ uр┤╣ : Tmр┤г ╬Њр┤╣)
        Рєњ tyOfр┤г tр┤╣ РЅА (P [ idSр┤╣ ,р┤╣ ttр┤╣ РѕХ[ tyOfttр┤╣ ] ]Tр┤╣)
        Рєњ tyOfр┤г uр┤╣ РЅА (P [ idSр┤╣ ,р┤╣ ffр┤╣ РѕХ[ tyOfffр┤╣ ] ]Tр┤╣)
        Рєњ (bр┤╣ : Tmр┤г ╬Њр┤╣) Рєњ tyOfр┤г bр┤╣ РЅА ­Юћ╣р┤╣ [ idSр┤╣ ]Tр┤╣
        Рєњ Tmр┤г ╬Њр┤╣
      elim­Юћ╣[]р┤╣
        : (P : Tyр┤г (╬Њр┤╣ ,р┤╣ ­Юћ╣р┤╣)) (tр┤╣ uр┤╣ : Tmр┤г ╬Њр┤╣) (pt : tyOfр┤г tр┤╣ РЅА _) (pu : tyOfр┤г uр┤╣ РЅА _) Рєњ (bр┤╣ : Tmр┤г ╬Њр┤╣) (pb : tyOfр┤г bр┤╣ РЅА ­Юћ╣р┤╣ [ idSр┤╣ ]Tр┤╣)
        Рєњ (ptРѓѓ : tyOfр┤г (tр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) РЅА P [ ¤Ѓр┤╣ РєЉ­Юћ╣р┤╣ ]Tр┤╣ [ idSр┤╣ ,р┤╣ ttр┤╣ РѕХ[ tyOfttр┤╣ ] ]Tр┤╣)
        Рєњ (puРѓѓ : tyOfр┤г (uр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) РЅА P [ ¤Ѓр┤╣ РєЉ­Юћ╣р┤╣ ]Tр┤╣ [ idSр┤╣ ,р┤╣ ffр┤╣ РѕХ[ tyOfffр┤╣ ] ]Tр┤╣)
        Рєњ (pbРѓѓ : tyOfр┤г (bр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) РЅА ­Юћ╣р┤╣ [ idSр┤╣ ]Tр┤╣)
        Рєњ (P [ idSр┤╣ ,р┤╣ bр┤╣ РѕХ[ pb ] ]Tр┤╣ [ ¤Ѓр┤╣ ]Tр┤╣) РЅА (P [ (¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣) ,р┤╣ ¤ђРѓѓр┤╣ idSр┤╣ РѕХ[ ­Юћ╣[]Рѓѓр┤╣ ] ]Tр┤╣ [ idSр┤╣ ,р┤╣ bр┤╣ [ ¤Ѓр┤╣ ]tр┤╣ РѕХ[ pbРѓѓ ] ]Tр┤╣)
        Рєњ (elim­Юћ╣р┤╣ P tр┤╣ uр┤╣ pt pu bр┤╣ pb) [ ¤Ѓр┤╣ ]tр┤╣
        РЅА elim­Юћ╣р┤╣ (P [ ¤Ѓр┤╣ РєЉ­Юћ╣р┤╣ ]Tр┤╣) (tр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) (uр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) ptРѓѓ puРѓѓ (bр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) pbРѓѓ

  record UnivBoolр┤╣ (C : SCр┤╣) (Univрхљ : Univр┤╣ C) (Boolрхљ : Boolр┤╣ C) : Set (РёЊРѓЂ Ріћ РёЊРѓѓ Ріћ РёЊРѓЃ Ріћ РёЊРѓё) where
    open SCр┤╣ C
    open Univр┤╣ Univрхљ
    open Boolр┤╣ Boolрхљ

    field
      ­ЮЋЊр┤╣
        : Tmр┤г ╬Њр┤╣
      tyOfр┤╣
        : tyOfр┤г {╬Њр┤╣ = ╬Њр┤╣} ­ЮЋЊр┤╣ РЅА Uр┤╣
      ­ЮЋЊ[]р┤╣
        : ­ЮЋЊр┤╣ [ ¤Ѓр┤╣ ]tр┤╣ РЅА ­ЮЋЊр┤╣
      tyOf­ЮЋЊр┤╣
        : tyOfр┤г {╬Њр┤╣} ­ЮЋЊр┤╣ РЅА Uр┤╣
      Elр┤╣­ЮЋЊр┤╣
        : Elр┤╣ {╬Њр┤╣} ­ЮЋЊр┤╣ tyOf­ЮЋЊр┤╣ РЅА ­Юћ╣р┤╣
  
  record UnivPiр┤╣ (C : SCр┤╣) (Univрхљ : Univр┤╣ C) (Boolрхљ : Boolр┤╣ C) (Piрхљ : Piр┤╣ C) : Set (РёЊРѓЂ Ріћ РёЊРѓѓ Ріћ РёЊРѓЃ Ріћ РёЊРѓё) where
    open SCр┤╣ C
    open Univр┤╣ Univрхљ
    open Piр┤╣   Piрхљ

    field
      El[]Рѓѓр┤╣
        : (uр┤╣ : Tmр┤г ╬ћр┤╣) (pu : tyOfр┤г uр┤╣ РЅА Uр┤╣)(pu' : tyOfр┤г (uр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) РЅА Uр┤╣)
        Рєњ tyOfр┤г (¤ђРѓѓр┤╣ {╬Њр┤╣ ,р┤╣ Elр┤╣ (uр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) pu'} idSр┤╣) РЅА Elр┤╣ uр┤╣ pu [ ¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣ ]Tр┤╣

    _РєЉElр┤╣
      : (¤Ѓр┤╣ : Subр┤г ╬Њр┤╣ ╬ћр┤╣) {uр┤╣ : Tmр┤г ╬ћр┤╣} {pu : tyOfр┤г uр┤╣ РЅА Uр┤╣} {pu' : tyOfр┤г (uр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) РЅА Uр┤╣}
      Рєњ Subр┤г (╬Њр┤╣ ,р┤╣ Elр┤╣ (uр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) pu') (╬ћр┤╣ ,р┤╣ Elр┤╣ uр┤╣ pu)
    (¤Ѓр┤╣ РєЉElр┤╣) {uр┤╣} {pu} {pu'} = (¤Ѓр┤╣ Рѕўр┤╣ ¤ђРѓЂр┤╣ idSр┤╣) ,р┤╣ ¤ђРѓѓр┤╣ idSр┤╣ РѕХ[ El[]Рѓѓр┤╣ uр┤╣ pu pu' ]

    field
      ¤ђр┤╣
        : (a : Tmр┤г ╬Њр┤╣) (pa : tyOfр┤г a РЅА Uр┤╣)
        Рєњ (bр┤╣ : Tmр┤г (╬Њр┤╣ ,р┤╣ Elр┤╣ a pa)) (pb : tyOfр┤г bр┤╣ РЅА Uр┤╣)
        Рєњ Tmр┤г ╬Њр┤╣
      ¤ђ[]р┤╣
        : (aр┤╣ : Tmр┤г ╬Њр┤╣) (pa : tyOfр┤г aр┤╣ РЅА Uр┤╣)
        Рєњ (bр┤╣ : Tmр┤г (╬Њр┤╣ ,р┤╣ Elр┤╣ aр┤╣ pa)) (pb : tyOfр┤г bр┤╣ РЅА Uр┤╣)
        Рєњ (pa' : tyOfр┤г (aр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) РЅА Uр┤╣)
        Рєњ (pb' : tyOfр┤г (bр┤╣ [ ¤Ѓр┤╣ РєЉElр┤╣ ]tр┤╣) РЅА Uр┤╣)
        Рєњ (¤ђр┤╣ aр┤╣ pa bр┤╣ pb) [ ¤Ѓр┤╣ ]tр┤╣ РЅА ¤ђр┤╣ (aр┤╣ [ ¤Ѓр┤╣ ]tр┤╣) pa' (bр┤╣ [ ¤Ѓр┤╣ РєЉElр┤╣ ]tр┤╣) pb'
      tyOf¤ђр┤╣
        : (a : Tmр┤г ╬Њр┤╣) (pa : tyOfр┤г a РЅА Uр┤╣) (bр┤╣ : Tmр┤г (╬Њр┤╣ ,р┤╣ Elр┤╣ a pa)) (pb : tyOfр┤г bр┤╣ РЅА Uр┤╣)
        Рєњ tyOfр┤г (¤ђр┤╣ a pa bр┤╣ pb) РЅА Uр┤╣
      El¤ђр┤╣
        : (aр┤╣ : Tmр┤г ╬Њр┤╣) (pa : tyOfр┤г aр┤╣ РЅА Uр┤╣)
        Рєњ (bр┤╣ : Tmр┤г (╬Њр┤╣ ,р┤╣ Elр┤╣ aр┤╣ pa)) (pb : tyOfр┤г bр┤╣ РЅА Uр┤╣)
        Рєњ Elр┤╣ (¤ђр┤╣ aр┤╣ pa bр┤╣ pb) (tyOf¤ђр┤╣ aр┤╣ pa bр┤╣ pb) РЅА ╬ар┤╣ (Elр┤╣ aр┤╣ pa) (Elр┤╣ bр┤╣ pb)

module _
  (mot : Motive РёЊРѓЂ РёЊРѓѓ РёЊРѓЃ РёЊРѓё) (SCрхљ : SCр┤╣ mot) (Boolрхљ : Boolр┤╣ mot SCрхљ) (Univрхљ : Univр┤╣ mot SCрхљ) (Piрхљ : Piр┤╣ mot SCрхљ) where

  open Motive mot
  open SCр┤╣ SCрхљ
  open Boolр┤╣ Boolрхљ
  open Univр┤╣ Univрхљ
  open Piр┤╣ Piрхљ

  recCtx  : Ctx Рєњ Ctxр┤г
  recTy   : Ty ╬Њ Рєњ Tyр┤г (recCtx ╬Њ)
  recTm   : Tm ╬Њ Рєњ Tmр┤г (recCtx ╬Њ)
  recSub  : Sub ╬Њ ╬ћ Рєњ Subр┤г (recCtx ╬Њ) (recCtx ╬ћ)
  recTyOf : (t : Tm ╬Њ) Рєњ tyOf t РЅА A Рєњ tyOfр┤г (recTm t) РЅА recTy A

  recCtx РѕЁ       = РѕЁр┤╣
  recCtx (╬Њ , A) = recCtx ╬Њ ,р┤╣ recTy A

  recTmРЪе¤ђРѓѓidSРЪЕРЅА¤ђРѓѓр┤╣idSр┤╣          : recTm (¤ђРѓѓ {A = A} idS) РЅА ¤ђРѓѓр┤╣ idSр┤╣
  recTmРЪеt[¤Ѓ]РЪЕ=recTmt[recSub¤Ѓ]tр┤╣ : recTm (t [ ¤Ѓ ]) РЅА recTm t [ recSub ¤Ѓ ]tр┤╣

  recTy (A [ ¤Ѓ ]) = recTy A [ recSub ¤Ѓ ]Tр┤╣
  recTy ­Юћ╣         = ­Юћ╣р┤╣
  recTy U         = Uр┤╣
  recTy (El u p)  = Elр┤╣ (recTm u) (recTyOf u p)
  recTy (╬а A B)   = ╬ар┤╣ (recTy A) (recTy B)
  recTy ([idS]T {A = A} i) = [idS]Tр┤╣ {Aр┤╣ = recTy A} i
  recTy ([Рѕў]T A ¤Ѓ ¤ё i)     = [Рѕў]Tр┤╣ (recTy A) (recSub ¤Ѓ) (recSub ¤ё) i
  recTy (U[] {¤Ѓ = ¤Ѓ} i)    = U[]р┤╣ {¤Ѓр┤╣ = recSub ¤Ѓ} i
  recTy (El[] ¤ё u p q i)   = {!El[]р┤╣ (recSub ¤ё) (recTm u) (recTyOf u p) i!}
   where
    foo : (tyOf[]р┤╣ РѕЎ cong (╬╗ z Рєњ z [ recSub ¤ё ]Tр┤╣) (recTyOf u p) РѕЎ U[]р┤╣) РЅА {!recTyOf (u Foo.[ ¤ё ]t) q!}
    foo = {!!}
  -- (El[]р┤╣ (recSub ¤ё) (recTm u) (recTyOf u p) {!(cong tyOfр┤г (recTmРЪеt[¤Ѓ]РЪЕ=recTmt[recSub¤Ѓ]tр┤╣ {t = u} {¤Ѓ = ¤ё})) РѕЎ recTyOf (u [ ¤ё ]) q!}) i
  recTy (El[]Рѓѓ u pu pu' i) = {!!}
  recTy (╬а[] i) = {!!}
  recTy (­Юћ╣[] {¤Ѓ = ¤Ѓ} i) = ­Юћ╣[]р┤╣ {¤Ѓр┤╣ = recSub ¤Ѓ} i
  recTy (­Юћ╣[]Рѓѓ {╬Њ = ╬Њ} {╬ћ} {¤ё = ¤ё} i) = {!!} -- ({!cong tyOfр┤г (recTmРЪе¤ђРѓѓidSРЪЕРЅА¤ђРѓѓр┤╣idSр┤╣ {{!╬Њ!}} {A = ­Юћ╣})!} РѕЎ ­Юћ╣[]Рѓѓр┤╣ {¤ёр┤╣ = recSub ¤ё}) i
  recTy (El­ЮЋЊ i) = {!!}
  recTy (tyOf¤ђ a pa b pb i) = {!!}
  recTy (El¤ђ a pa b pb i) = {!!}
  recTy (Ty-is-set A AРѓЂ x y i iРѓЂ) = {!!}

  recSub РѕЁ             = РѕЁSр┤╣
  recSub (¤Ѓ , t РѕХ[ p ]) = recSub ¤Ѓ ,р┤╣ recTm t РѕХ[ recTyOf t p ]
  recSub idS            = idSр┤╣
  recSub (¤ё Рѕў ¤Ѓ)        = recSub ¤ё Рѕўр┤╣ recSub ¤Ѓ
  recSub (¤ђРѓЂ ¤Ѓ)         = ¤ђРѓЂр┤╣ (recSub ¤Ѓ)
  recSub (╬▓¤ђРѓЂ ¤Ѓ t p i)  = {!!}
  recSub ((idSРѕў ¤Ѓ) i)   = {!!}
  recSub ((¤Ѓ РѕўidS) i)   = {!!}
  recSub (assocS ¤Ѓ ¤ЃРѓЂ ¤ЃРѓѓ i) = {!!}
  recSub (,Рѕў ¤Ѓ t ¤ЃРѓЂ p q i)  = {!!}
  recSub (╬иРѕЁ ¤Ѓ i) = {!!}
  recSub (╬и¤ђ ¤Ѓ i) = {!!}


  recTm (t [ ¤Ѓ ]) = recTm t [ recSub ¤Ѓ ]tр┤╣
  recTm (¤ђРѓѓ ¤Ѓ)    = ¤ђРѓѓр┤╣ (recSub ¤Ѓ)
  recTm (app t x) = {!!}
  recTm (abs t)   = {!!}
  recTm tt        = {!!}
  recTm ff        = {!!}
  recTm (elim­Юћ╣ P t tРѓЂ x xРѓЂ tРѓѓ xРѓѓ) = {!!}
  recTm ­ЮЋЊ = {!!}
  recTm (¤ђ t pa tРѓЂ pb) = {!!}
  recTm (╬▓¤ђРѓѓ ¤Ѓ t p q i) = {!!}
  recTm ([idS]t t i) = {!!}
  recTm ([Рѕў]t t ¤Ѓ ¤ё i) = {!!}
  recTm (abs[] t i) = {!!}
  recTm (╬а╬▓ t i) = {!!}
  recTm (╬а╬и t p i) = {!!}
  recTm (tt[] i) = {!!}
  recTm (ff[] i) = {!!}
  recTm (elim­Юћ╣[] P t tРѓЂ pt pu tРѓѓ pb ptРѓѓ puРѓѓ pbРѓѓ x i) = {!!}
  recTm (­ЮЋЊ[] i) = {!!}
  recTm (¤ђ[] t pa tРѓЂ pb pa' pb' i) = {!!}

  recTmРЪе¤ђРѓѓidSРЪЕРЅА¤ђРѓѓр┤╣idSр┤╣ = refl
  recTmРЪеt[¤Ѓ]РЪЕ=recTmt[recSub¤Ѓ]tр┤╣ = refl

  recTyOf t p = {!!}
